<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Detail Barang - PinjamBarang</title>
<link rel="stylesheet" href="assets/css/style.css">
<style>
/* Improved detail page styles (updated) */
body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; background:#f5f6fa; margin:0; padding:0; }
.container { max-width:940px; margin:20px auto; padding:16px; box-sizing:border-box; }
.detail-card { background:#fff; border-radius:12px; padding:18px; box-shadow:0 6px 18px rgba(18,38,63,0.08); display:flex; gap:22px; align-items:flex-start; }
.img-wrap { background:#f0fbf4; border-radius:10px; padding:18px; display:flex; align-items:center; justify-content:center; min-width:340px; max-width:40%; }
.img-wrap img { width:100%; max-width:300px; border-radius:8px; object-fit:cover; display:block; }
.details { flex:1; min-width:200px; }
.title { margin:0 0 6px 0; font-size:22px; color:#13232b; }
.meta { color:#6b7280; margin-bottom:10px; font-weight:600; }
.price { color:#077a37; font-weight:800; font-size:20px; margin-bottom:10px; }
.summary { color:#374151; margin-bottom:12px; line-height:1.4; }
.avail { color:#077a37; font-weight:700; margin:10px 0; }
.spec-list { margin-top:10px; color:#374151; }
.spec-list dt { font-weight:700; margin-top:8px; }
.actions { margin-top:16px; display:flex; gap:10px; align-items:center; width:100%; }
.btn { padding:12px 14px; border-radius:8px; border:none; cursor:pointer; font-weight:700; }
.btn-primary { background:#077a37;color:#fff; flex:1; box-shadow:0 2px 6px rgba(7,122,55,0.18); }
.btn-primary:hover { filter:brightness(0.97); transform:translateY(-1px); }
.btn-secondary { background:transparent;color:#0b5ed7;border:1px solid #d1e7ff;padding:10px 12px;border-radius:8px; }
.back-link { display:inline-block; margin-bottom:12px; color:#0b5ed7; text-decoration:none; }
/* Responsive */
@media(max-width:820px){
  .detail-card { flex-direction:column; align-items:center; }
  .img-wrap { max-width:100%; min-width:auto; width:100%; }
  .img-wrap img { max-width:420px; }
  .details { width:100%; }
  .actions { flex-direction:column-reverse; }
  .btn-secondary { width:100%; }
}
</style>
</head>
<body>

<!-- reuse navbar from browsing.html -->
<nav class="navbar">
  <div class="logo"><img src="assets/img/LogoBW.png" alt="Logo" style="width:140px;height:55px;border-radius:6px;object-fit:cover"></div>
  <div class="menu-toggle" onclick="toggleMenu()">
    <span></span><span></span><span></span>
  </div>
  <div class="nav-links" id="navLinks">
    <a href="index.html">Home</a>
    <a href="browsing.html">Browsing</a>
    <a href="tentang.html">Tentang Kami</a>
    <a href="chat.html">Chat</a>
    <a href="login.html" class="login-btn">Log In / Sign In</a>
    <a href="pinjam.html" class="cart-link">
      <img src="assets/img/cart.png" alt="Cart" style="width:25px;vertical-align:middle;">
      <span class="cart-badge" id="cartCount">0</span>
    </a>
  </div>
</nav>

<div class="container">
  <a class="back-link" href="browsing.html">← Kembali ke Jelajah</a>

  <div id="content" class="detail-card">
    <div class="img-wrap"><img id="itemImg" src="assets/img/PH.png" alt="gambar barang"></div>
    <div class="details">
      <h2 id="itemName" class="title">Memuat...</h2>
      <div id="itemCategory" class="meta"></div>
      <div id="itemPrice" class="price"></div>
      <p id="itemSummary" class="summary">—</p>

      <div id="availability" class="avail" aria-live="polite"></div>

      <div>
        <h4 style="margin:0 0 6px 0">Spesifikasi</h4>
        <dl id="specList" class="spec-list"></dl>
      </div>

      <div class="actions" style="margin-top:18px">
        <button class="btn btn-primary" id="addCartBtn">Tambah ke Keranjang</button>
        <a class="btn btn-secondary" href="browsing.html">Lihat Semua</a>
      </div>
    </div>
  </div>
</div>

<footer class="footer" style="text-align:center;padding:12px 0;background:transparent;">
  © PinjamBarang — Prototype • dibuat untuk demo
</footer>

<script>
function toggleMenu(){ const navLinks = document.getElementById('navLinks'); navLinks.classList.toggle('active'); }

// Spesifikasi data (same as before)
const specs = {
  "Proyektor": { category:"Elektronik", price:100000, img:"assets/img/Projector.png", spesifikasi: {"Merek":"Generic","Resolusi":"1080p","Kecerahan":"3000 lumens","Port":"HDMI, USB, VGA","Berat":"1.2 kg","Kondisi":"Baik"} },
  "Kamera": { category:"Elektronik", price:80000, img:"assets/img/Kamera.png", spesifikasi: {"Merek":"Canon/Nikon","Tipe":"DSLR/Mirrorless","Resolusi":"24 MP","Lensa":"Kit 18-55mm","Aksesori":"Tas & baterai cadangan","Kondisi":"Baik"} },
  "Set Berkebun": { category:"Peralatan", price:25000, img:"assets/img/Gardening.png", spesifikasi: {"Isi":"Sekop, garpu, sarung tangan","Bahan":"Baja & kayu","Kondisi":"Baik"} },
  "Mesin Jahit": { category:"Peralatan", price:35000, img:"assets/img/Jahit.png", spesifikasi: {"Merek":"Jack","Tipe":"Elektrik portable","Fitur":"Beberapa jahitan, reverse","Kondisi":"Baik"} },
  "Tenda Camping": { category:"Hobi", price:60000, img:"assets/img/Tenda.png", spesifikasi: {"Kapasitas":"2-4 orang","Bahan":"Tahan air","Ukuran":"200x200x120 cm","Kondisi":"Baik"} },
  "Set Padel": { category:"Hobi", price:40000, img:"assets/img/Padel.png", spesifikasi: {"Isi":"2 raket, 3 bola","Merek":"Generic","Kondisi":"Baik"} },
  "Ranjang Bayi": { category:"Furnitur", price:45000, img:"assets/img/BC.png", spesifikasi: {"Ukuran":"120x60 cm","Bahan":"Kayu lapis","Fitur":"Bisa dirakit","Kondisi":"Baik"} },
  "Biola": { category:"Hobi", price:75000, img:"assets/img/Biola.png", spesifikasi: {"Ukuran":"4/4","Bahan":"Kayu spruce & maple","Termasuk":"Busur & kasing","Kondisi":"Baik"} },
  "Cello": { category:"Hobi", price:120000, img:"assets/img/Cello.png", spesifikasi: {"Ukuran":"4/4","Bahan":"Kayu solid","Termasuk":"Kursi & busur","Kondisi":"Baik"} },
  "Gitar Elektrik": { category:"Hobi", price:90000, img:"assets/img/Gitar Elektrik.png", spesifikasi: {"Merek":"Fender/Generic","Tipe":"Solid-body","Termasuk":"Kabel, strap","Kondisi":"Baik"} },
  "Teleskop": { category:"Hobi", price:110000, img:"assets/img/Teleskop.png", spesifikasi: {"Tipe":"Reflector","Aperture":"114 mm","Mount":"Alt-Az tripod","Termasuk":"Okuler 25mm & 10mm","Kondisi":"Baik"} },
  "Air Fryer": { category:"Furnitur", price:50000, img:"assets/img/Air Fyer.png", spesifikasi: {"Kapasitas":"3.5 L","Daya":"1500W","Fitur":"Timer, temperatur adjustable","Kondisi":"Baik"} },
  "Griller": { category:"Furnitur", price:45000, img:"assets/img/Griller.png", spesifikasi: {"Tipe":"Electric griller","Daya":"2000W","Ukuran":"Medium","Kondisi":"Baik"} },
  "Oven": { category:"Furnitur", price:70000, img:"assets/img/Oven.png", spesifikasi: {"Tipe":"Countertop oven","Kapasitas":"20 L","Daya":"1500W","Fitur":"Convection","Kondisi":"Baik"} },
  "Kipas Angin": { category:"Elektronik", price:20000, img:"assets/img/Kipas Angin.png", spesifikasi: {"Tipe":"Tower/meja","Kecepatan":"3-level","Daya":"50-60W","Kondisi":"Baik"} },
  "Printer": { category:"Elektronik", price:60000, img:"assets/img/Printer.png", spesifikasi: {"Tipe":"Inkjet/Laser","Fitur":"Print, scan, copy","Konektivitas":"USB/Wi-Fi","Kondisi":"Baik"} },
  "DJ Controller": { category:"Hobi", price:130000, img:"assets/img/DJ Controller.png", spesifikasi: {"Merek":"Pioneer/Numark","Fitur":"Mixer, jog wheels, pads","Konektivitas":"USB","Kondisi":"Baik"} },
  "Set Alat Golf": { category:"Hobi", price:150000, img:"assets/img/Set Alat Golf.png", spesifikasi: {"Isi":"Driver, iron set, putter, tas","Merek":"Generic","Kondisi":"Baik"} }
};

function qs(key){ const params = new URLSearchParams(window.location.search); return params.get(key); }

// Inventory/bookings helpers (reuse same keys as browsing)
const defaultStock = 5;
function getInventory(){ return JSON.parse(localStorage.getItem("inventory") || "{}"); }
function getBookings(){ return JSON.parse(localStorage.getItem("bookings") || "{}"); }

function computeAvailability(name){
  const inv = getInventory();
  const bookings = getBookings();
  const today = new Date(); today.setHours(0,0,0,0);
  const todayStr = today.toISOString().split('T')[0];
  const stock = (inv && inv[name]) !== undefined ? inv[name] : defaultStock;
  const bookedToday = (bookings[name] && bookings[name][todayStr]) || 0;
  return Math.max(0, stock - bookedToday);
}

// render item details including summary & availability
function showItem(name){
  const item = specs[name];
  const title = document.getElementById('itemName');
  const img = document.getElementById('itemImg');
  const cat = document.getElementById('itemCategory');
  const priceEl = document.getElementById('itemPrice');
  const dl = document.getElementById('specList');
  const summaryEl = document.getElementById('itemSummary');
  const availEl = document.getElementById('availability');
  dl.innerHTML = '';
  if(!item){
    title.textContent = 'Barang tidak ditemukan';
    img.src = 'assets/img/PH.png';
    cat.textContent = '';
    priceEl.textContent = '';
    summaryEl.textContent = '';
    availEl.textContent = '';
    document.getElementById('addCartBtn').disabled = true;
    return;
  }
  title.textContent = name;
  img.src = item.img || 'assets/img/PH.png';
  img.alt = name;
  cat.textContent = `Kategori: ${item.category || '-'}`;
  priceEl.textContent = item.price ? `Rp ${item.price.toLocaleString()} / hari` : '';
  summaryEl.textContent = item.summary || (item.spesifikasi ? Object.values(item.spesifikasi).slice(0,2).join(' · ') : '');

  const s = item.spesifikasi || {};
  for(const k in s){
    const dt = document.createElement('dt'); dt.textContent = k;
    const dd = document.createElement('dd'); dd.textContent = s[k];
    dl.appendChild(dt); dl.appendChild(dd);
  }

  // availability
  const avail = computeAvailability(name);
  availEl.textContent = `Tersedia hari ini: ${avail}`;
  availEl.style.display = 'block';
  document.getElementById('addCartBtn').disabled = avail <= 0;
}

// simple add to cart (minimal item, qty 1, days 1)
function addToCartDetail(){
  const name = document.getElementById('itemName').textContent;
  if(!name || name === 'Memuat...' || name === 'Barang tidak ditemukan') return;
  const avail = computeAvailability(name);
  if(avail <= 0) return alert('Stok tidak tersedia hari ini.');
  const item = specs[name];
  const cartItem = { name: name, price: item ? item.price : 0, qty: 1, days: 1, total: (item ? item.price : 0) };
  const cart = JSON.parse(localStorage.getItem('cart')||'[]');
  cart.push(cartItem);
  localStorage.setItem('cart', JSON.stringify(cart));
  updateCartCount();
  alert(`${name} ditambahkan ke keranjang ✅`);
}

function updateCartCount(){ const cart = JSON.parse(localStorage.getItem('cart')||'[]'); const el = document.getElementById('cartCount'); if(el) el.textContent = cart.length; }

document.addEventListener('DOMContentLoaded', ()=>{
  const raw = (new URLSearchParams(window.location.search)).get('item') || (new URLSearchParams(window.location.search)).get('name') || '';
  const name = raw ? decodeURIComponent(raw) : '';
  showItem(name);
  document.getElementById('addCartBtn').addEventListener('click', addToCartDetail);
  updateCartCount();
});
</script>

</body>
</html>