<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Pembayaran - PinjamBarang</title>
<link rel="stylesheet" href="assets/css/style.css">
<style>
body {
  font-family: 'Segoe UI', Arial, sans-serif;
  background-color: #f5f7fa;
  margin: 0;
  padding: 0;
}

.container {
  max-width: 800px;
  margin: 40px auto;
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 4px 14px rgba(0,0,0,0.1);
  padding: 25px 30px;
  transition: all 0.3s ease;
}

h2 {
  text-align: center;
  color: #333;
  margin-bottom: 15px;
}

.cart-item {
  border-bottom: 1px solid #e0e0e0;
  padding: 12px 0;
}

.cart-item h4 {
  margin: 0;
  color: #222;
}

.cart-item p {
  margin: 4px 0;
  color: #555;
}

.cart-item button {
  background-color: crimson;
  color: white;
  border: none;
  padding: 6px 10px;
  border-radius: 6px;
  cursor: pointer;
}

.cart-item button:hover {
  background-color: darkred;
}

.total-section {
  text-align: right;
  margin-top: 20px;
  font-size: 18px;
  font-weight: bold;
}

.payment-options {
  margin-top: 25px;
}

.payment-options h3 {
  color: #444;
  margin-bottom: 10px;
}

.payment-options label {
  display: block;
  margin: 8px 0;
  font-size: 16px;
}

.payment-options input[type="radio"] {
  margin-right: 8px;
  accent-color: #2a8;
}

button.pay-btn {
  display: block;
  width: 100%;
  padding: 12px;
  background-color: #28a745;
  color: white;
  font-size: 16px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  margin-top: 20px;
  transition: background 0.2s ease;
}

button.pay-btn:hover {
  background-color: #1e7e34;
}

/* Popup Modal */
.popup {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.5);
  display: none;
  align-items: center;
  justify-content: center;
  animation: fadeIn 0.4s;
}

.popup.active {
  display: flex;
}

.popup-content {
  background: #fff;
  padding: 25px 30px;
  border-radius: 10px;
  text-align: center;
  max-width: 400px;
  animation: popIn 0.3s ease;
}

.popup-content h3 {
  color: #333;
  margin-bottom: 10px;
}

.popup-content p {
  color: #555;
}

.popup-content button {
  margin-top: 20px;
  background: #28a745;
  color: white;
  border: none;
  padding: 10px 20px;
  border-radius: 6px;
  cursor: pointer;
}

.popup-content button:hover {
  background: #218838;
}

@keyframes fadeIn {
  from {opacity: 0;}
  to {opacity: 1;}
}

@keyframes popIn {
  from {transform: scale(0.8); opacity: 0;}
  to {transform: scale(1); opacity: 1;}
}
</style>
</head>

<body>

<nav class="navbar">
  <div class="logo"><img src="assets/img/LogoBW.png" alt="Logo" style="width:140px;height:55px;border-radius:6px;object-fit:cover"></div>
  <div class="nav-links">
    <a href="index.html">Home</a>
    <a href="browsing.html">Browsing</a>
    <a href="tentang.html">Tentang Kami</a>
    <a href="chat.html">Chat</a>
    <a href="login.html" class="login-btn">Log In / Sign In</a>
    <a href="pinjam.html" class="cart-link active">
      <img src="assets/img/cart.png" alt="Cart" style="width:25px;vertical-align:middle;">
      <span class="cart-badge" id="cartCount">0</span>
    </a>
  </div>
</nav>

<div class="container">
  <h2>Keranjang & Pembayaran</h2>
  <div id="cartContainer"></div>

  <div class="total-section">
    Total Pembayaran: <span id="totalPrice">Rp 0</span>
  </div>

  <div class="payment-options">
    <h3>Metode Pembayaran</h3>
    <label><input type="radio" name="payment" value="transfer"> Transfer Bank (BCA / Mandiri / BRI)</label>
    <label><input type="radio" name="payment" value="ewallet"> E-Wallet (OVO / GoPay / Dana)</label>
    <label><input type="radio" name="payment" value="cod"> Cash On Delivery (COD)</label>
  </div>

  <button class="pay-btn" onclick="lanjutPembayaran()">ðŸ’³ Bayar Sekarang</button>
</div>

<!-- Popup Confirmation -->
<div class="popup" id="popup">
  <div class="popup-content">
    <h3>ðŸŽ‰ Pembayaran Berhasil!</h3>
    <p>Terima kasih telah menggunakan <strong>PinjamBarang</strong>.<br>Transaksi Anda telah diproses.</p>
    <button onclick="tutupPopup()">Selesai</button>
  </div>
</div>

<footer class="footer">
  Â© PinjamBarang â€” Prototype â€¢ dibuat untuk demo
</footer>

<script>
// === Load Cart ===
function loadCart() {
  const cart = JSON.parse(localStorage.getItem("cart") || "[]");
  const cartContainer = document.getElementById("cartContainer");
  const totalPriceElem = document.getElementById("totalPrice");
  const cartCountElem = document.getElementById("cartCount");
  
  cartContainer.innerHTML = "";
  let grandTotal = 0;
  
  if (cart.length === 0) {
    cartContainer.innerHTML = "<p style='text-align:center;'>Keranjang kosong.</p>";
    totalPriceElem.textContent = "Rp 0";
    cartCountElem.textContent = 0;
    return;
  }
  
  cart.forEach((item, index) => {
    const qty = item.qty || 1;
    const days = item.days || 1;
    const subtotal = item.total || (item.price * qty * days);
    grandTotal += subtotal;
    
    cartContainer.innerHTML += `
      <div class="cart-item">
        <h4>${item.name}</h4>
        <p>Jumlah: ${qty} â€¢ Durasi: ${days} hari</p>
        <p>Harga per hari: Rp ${item.price.toLocaleString()}</p>
        <p><strong>Subtotal: Rp ${subtotal.toLocaleString()}</strong></p>
        <button onclick="removeItem(${index})">Hapus</button>
      </div>
    `;
  });
  
  totalPriceElem.textContent = "Rp " + grandTotal.toLocaleString();
  cartCountElem.textContent = cart.length;
}

// === Remove Item ===
function removeItem(index) {
  let cart = JSON.parse(localStorage.getItem("cart") || "[]");
  cart.splice(index, 1);
  localStorage.setItem("cart", JSON.stringify(cart));
  loadCart();
}

// === Lanjut Pembayaran ===
function lanjutPembayaran() {
  const cart = JSON.parse(localStorage.getItem("cart") || "[]");
  const selected = document.querySelector('input[name="payment"]:checked');
  
  if (cart.length === 0) return alert("Keranjang masih kosong.");
  if (!selected) return alert("Silakan pilih metode pembayaran terlebih dahulu.");

  const total = cart.reduce((sum, item) => sum + (item.total || (item.price * (item.qty || 1) * (item.days || 1))), 0);
  document.getElementById("popup").classList.add("active");
  localStorage.removeItem("cart");
  document.getElementById("cartContainer").innerHTML = "<p style='text-align:center;'>Keranjang kosong.</p>";
  document.getElementById("totalPrice").textContent = "Rp 0";
  document.getElementById("cartCount").textContent = 0;
}

// === Tutup Popup ===
function tutupPopup() {
  const popup = document.getElementById("popup");
  popup.classList.remove("active");
  setTimeout(() => { window.location.href = "index.html"; }, 400);
}

// === Init ===
window.onload = loadCart;
</script>

</body>
</html>
